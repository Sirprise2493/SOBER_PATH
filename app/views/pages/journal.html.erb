<%= turbo_stream_from [current_user, :journal_contents] %>

<section class="journal-page" data-controller="scroll-top">
  <div class="journal-nav journal-nav--top">
    <div class="journal-nav__slot journal-nav__slot--left">
      <% if @previous_entry_date.present? %>
        <%= link_to "← Previous entry",
                    journal_path(
                      date: @previous_entry_date,
                      calendar_date: @calendar_date
                    ),
                    class: "journal-nav__button",
                    data: { action: "click->scroll-top#go" } %>
      <% else %>
        <span class="journal-nav__button journal-nav__button--disabled">
          ← Previous entry
        </span>
      <% end %>
    </div>

    <div class="journal-nav__slot journal-nav__slot--center">
      <% if @date == @today %>
        <button
          type="button"
          class="journal-nav__button journal-nav__button--calendar"
          data-action="click->scroll-top#toggleCalendar"
          data-scroll-top-target="calendarButton"
          aria-expanded="false">
          Calendar
        </button>
      <% else %>
        <%= link_to "Today",
                    journal_path(
                      date: @today,
                      calendar_date: @calendar_date
                    ),
                    class: "journal-nav__button journal-nav__button--today",
                    data: { action: "click->scroll-top#go" } %>
      <% end %>
    </div>

    <div class="journal-nav__slot journal-nav__slot--right">
      <% if @next_entry_date.present? %>
        <%= link_to "Next entry →",
                    journal_path(
                      date: @next_entry_date,
                      calendar_date: @calendar_date
                    ),
                    class: "journal-nav__button",
                    data: { action: "click->scroll-top#go" } %>
      <% else %>
        <span class="journal-nav__button journal-nav__button--disabled">
          Next entry →
        </span>
      <% end %>
    </div>
  </div>

  <% if @date == @today %>
    <div
      data-scroll-top-target="calendarPanel"
      class="journal-calendar-panel">
      <%= render "pages/journal/journal_calendar",
                 date: @date,
                 today: @today,
                 calendar_date: @calendar_date,
                 entry_dates: @entry_dates %>
    </div>
  <% end %>

  <%= render "pages/journal/journal_book",
             journal_content: @journal_content,
             date: @date,
             today: @today %>

</section>
