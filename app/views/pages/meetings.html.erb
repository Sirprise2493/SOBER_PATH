<%= simple_form_for :search, url: meetings_path, method: :get, html: { class: "mb-3" } do |f| %>
  <%= f.input :address,
    label: "Adresse",
    input_html: { value: params[:address].presence || current_user&.address } %>

  <div class="mb-3" data-controller="range">
    <label class="form-label">
      Radius: <span data-range-target="label"><%= number_with_precision(@radius_km || 20, precision: 1) %></span> km
    </label>
    <%= f.input :radius_km,
      as: :range,
      label: false,
      input_html: {
        min: 0.3, max: 50, step: 0.1,
        value: (@radius_km || 20),
        data: { action: "input->range#update" }
      } %>
  </div>

  <%= f.button :submit, "Suchen", class: "btn btn-primary" %>
<% end %>

<div style="width:100%; height:600px;"
     data-controller="map"
     data-map-markers-value='<%= raw @markers.to_json %>'
     data-map-api-key-value='<%= ENV["MAPBOX_API_KEY"] %>'
     data-map-center-value='<%= raw({ lat: @center_lat, lng: @center_lng }.to_json) %>'
     data-map-radius-km-value='<%= @radius_km %>'>
</div>
